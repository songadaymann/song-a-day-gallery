(function(){const X=document.createElement("link").relList;if(X&&X.supports&&X.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))N(i);new MutationObserver(i=>{for(const b of i)if(b.type==="childList")for(const q of b.addedNodes)q.tagName==="LINK"&&q.rel==="modulepreload"&&N(q)}).observe(document,{childList:!0,subtree:!0});function Q(i){const b={};return i.integrity&&(b.integrity=i.integrity),i.referrerPolicy&&(b.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?b.credentials="include":i.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function N(i){if(i.ep)return;i.ep=!0;const b=Q(i);fetch(i.href,b)}})();function tt({icon:_,label:X,onClick:Q}){const N=document.createElement("button");return N.className="icon-button",N.title=X,N.innerHTML=`<span class="material-icons">${_}</span>`,typeof Q=="function"&&N.addEventListener("click",Q),N}var an=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sn(_){return _&&_.__esModule&&Object.prototype.hasOwnProperty.call(_,"default")?_.default:_}var zt={exports:{}};/*! algoliasearch.umd.js | 4.24.0 | Â© Algolia, inc. | https://github.com/algolia/algoliasearch-client-javascript */(function(_,X){(function(Q,N){_.exports=N()})(an,function(){function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?N(Object(n),!0).forEach(function(r){Q(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function b(e,t){if(e==null)return{};var n,r,o=function(l,a){if(l==null)return{};var u,x,g={},D=Object.keys(l);for(x=0;x<D.length;x++)u=D[x],a.indexOf(u)>=0||(g[u]=l[u]);return g}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function q(e,t){return function(n){if(Array.isArray(n))return n}(e)||function(n,r){if(Symbol.iterator in Object(n)||Object.prototype.toString.call(n)==="[object Arguments]"){var o=[],s=!0,l=!1,a=void 0;try{for(var u,x=n[Symbol.iterator]();!(s=(u=x.next()).done)&&(o.push(u.value),!r||o.length!==r);s=!0);}catch(g){l=!0,a=g}finally{try{s||x.return==null||x.return()}finally{if(l)throw a}}return o}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function z(e){return function(t){if(Array.isArray(t)){for(var n=0,r=new Array(t.length);n<t.length;n++)r[n]=t[n];return r}}(e)||function(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function F(e){var t,n="algoliasearch-client-js-".concat(e.key),r=function(){return t===void 0&&(t=e.localStorage||window.localStorage),t},o=function(){return JSON.parse(r().getItem(n)||"{}")},s=function(a){r().setItem(n,JSON.stringify(a))},l=function(){var a=e.timeToLive?1e3*e.timeToLive:null,u=o(),x=Object.fromEntries(Object.entries(u).filter(function(D){return q(D,2)[1].timestamp!==void 0}));if(s(x),a){var g=Object.fromEntries(Object.entries(x).filter(function(D){var j=q(D,2)[1],B=new Date().getTime();return!(j.timestamp+a<B)}));s(g)}};return{get:function(a,u){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}};return Promise.resolve().then(function(){l();var g=JSON.stringify(a);return o()[g]}).then(function(g){return Promise.all([g?g.value:u(),g!==void 0])}).then(function(g){var D=q(g,2),j=D[0],B=D[1];return Promise.all([j,B||x.miss(j)])}).then(function(g){return q(g,1)[0]})},set:function(a,u){return Promise.resolve().then(function(){var x=o();return x[JSON.stringify(a)]={timestamp:new Date().getTime(),value:u},r().setItem(n,JSON.stringify(x)),u})},delete:function(a){return Promise.resolve().then(function(){var u=o();delete u[JSON.stringify(a)],r().setItem(n,JSON.stringify(u))})},clear:function(){return Promise.resolve().then(function(){r().removeItem(n)})}}}function v(e){var t=z(e.caches),n=t.shift();return n===void 0?{get:function(r,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}},l=o();return l.then(function(a){return Promise.all([a,s.miss(a)])}).then(function(a){return q(a,1)[0]})},set:function(r,o){return Promise.resolve(o)},delete:function(r){return Promise.resolve()},clear:function(){return Promise.resolve()}}:{get:function(r,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}};return n.get(r,o,s).catch(function(){return v({caches:t}).get(r,o,s)})},set:function(r,o){return n.set(r,o).catch(function(){return v({caches:t}).set(r,o)})},delete:function(r){return n.delete(r).catch(function(){return v({caches:t}).delete(r)})},clear:function(){return n.clear().catch(function(){return v({caches:t}).clear()})}}}function Z(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{serializable:!0},t={};return{get:function(n,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{miss:function(){return Promise.resolve()}},s=JSON.stringify(n);if(s in t)return Promise.resolve(e.serializable?JSON.parse(t[s]):t[s]);var l=r(),a=o&&o.miss||function(){return Promise.resolve()};return l.then(function(u){return a(u)}).then(function(){return l})},set:function(n,r){return t[JSON.stringify(n)]=e.serializable?JSON.stringify(r):r,Promise.resolve(r)},delete:function(n){return delete t[JSON.stringify(n)],Promise.resolve()},clear:function(){return t={},Promise.resolve()}}}function ie(e,t,n){var r={"x-algolia-api-key":n,"x-algolia-application-id":t};return{headers:function(){return e===J.WithinHeaders?r:{}},queryParameters:function(){return e===J.WithinQueryParameters?r:{}}}}function M(e){var t=0;return e(function n(){return t++,new Promise(function(r){setTimeout(function(){r(e(n))},Math.min(100*t,1e3))})})}function I(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(n,r){return Promise.resolve()};return Object.assign(e,{wait:function(n){return I(e.then(function(r){return Promise.all([t(r,n),r])}).then(function(r){return r[1]}))}})}function ee(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[n],e[n]=r}return e}function P(e,t){return t&&Object.keys(t).forEach(function(n){e[n]=t[n](e)}),e}function w(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=0;return e.replace(/%s/g,function(){return encodeURIComponent(n[o++])})}var J={WithinQueryParameters:0,WithinHeaders:1};function te(e,t){var n=e||{},r=n.data||{};return Object.keys(n).forEach(function(o){["timeout","headers","queryParameters","data","cacheable"].indexOf(o)===-1&&(r[o]=n[o])}),{data:Object.entries(r).length>0?r:void 0,timeout:n.timeout||t,headers:n.headers||{},queryParameters:n.queryParameters||{},cacheable:n.cacheable}}var me={Read:1,Write:2,Any:3},Ae=1,Ge=2,je=3;function ge(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ae;return i(i({},e),{},{status:t,lastUpdate:Date.now()})}function rt(e){return typeof e=="string"?{protocol:"https",url:e,accept:me.Any}:{protocol:e.protocol||"https",url:e.url,accept:e.accept||me.Any}}var ae="DELETE",U="GET",k="POST",Be="PUT";function Ce(e,t){return Promise.all(t.map(function(n){return e.get(n,function(){return Promise.resolve(ge(n))})})).then(function(n){var r=n.filter(function(l){return function(a){return a.status===Ae||Date.now()-a.lastUpdate>12e4}(l)}),o=n.filter(function(l){return function(a){return a.status===je&&Date.now()-a.lastUpdate<=12e4}(l)}),s=[].concat(z(r),z(o));return{getTimeout:function(l,a){return(o.length===0&&l===0?1:o.length+3+l)*a},statelessHosts:s.length>0?s.map(function(l){return rt(l)}):t}})}function Ie(e,t,n,r){var o=[],s=function(j,B){if(!(j.method===U||j.data===void 0&&B.data===void 0)){var R=Array.isArray(j.data)?j.data:i(i({},j.data),B.data);return JSON.stringify(R)}}(n,r),l=function(j,B){var R=i(i({},j.headers),B.headers),V={};return Object.keys(R).forEach(function(Y){var ue=R[Y];V[Y.toLowerCase()]=ue}),V}(e,r),a=n.method,u=n.method!==U?{}:i(i({},n.data),r.data),x=i(i(i({"x-algolia-agent":e.userAgent.value},e.queryParameters),u),r.queryParameters),g=0,D=function j(B,R){var V=B.pop();if(V===void 0)throw{name:"RetryError",message:"Unreachable hosts - your application id may be incorrect. If the error persists, please reach out to the Algolia Support team: https://alg.li/support .",transporterStackTrace:Fe(o)};var Y={data:s,headers:l,method:a,url:yt(V,n.path,x),connectTimeout:R(g,e.timeouts.connect),responseTimeout:R(g,r.timeout)},ue=function(le){var oe={request:Y,response:le,host:V,triesLeft:B.length};return o.push(oe),oe},Ze={onSuccess:function(le){return function(oe){try{return JSON.parse(oe.content)}catch(Me){throw function(Te,Ve){return{name:"DeserializationError",message:Te,response:Ve}}(Me.message,oe)}}(le)},onRetry:function(le){var oe=ue(le);return le.isTimedOut&&g++,Promise.all([e.logger.info("Retryable failure",be(oe)),e.hostsCache.set(V,ge(V,le.isTimedOut?je:Ge))]).then(function(){return j(B,R)})},onFail:function(le){throw ue(le),function(oe,Me){var Te=oe.content,Ve=oe.status,et=Te;try{et=JSON.parse(Te).message}catch{}return function(gt,Rt,on){return{name:"ApiError",message:gt,status:Rt,transporterStackTrace:on}}(et,Ve,Me)}(le,Fe(o))}};return e.requester.send(Y).then(function(le){return function(oe,Me){return function(Te){var Ve=Te.status;return Te.isTimedOut||function(et){var gt=et.isTimedOut,Rt=et.status;return!gt&&~~Rt==0}(Te)||~~(Ve/100)!=2&&~~(Ve/100)!=4}(oe)?Me.onRetry(oe):~~(oe.status/100)==2?Me.onSuccess(oe):Me.onFail(oe)}(le,Ze)})};return Ce(e.hostsCache,t).then(function(j){return D(z(j.statelessHosts).reverse(),j.getTimeout)})}function ye(e){var t=e.hostsCache,n=e.logger,r=e.requester,o=e.requestsCache,s=e.responsesCache,l=e.timeouts,a=e.userAgent,u=e.hosts,x=e.queryParameters,g={hostsCache:t,logger:n,requester:r,requestsCache:o,responsesCache:s,timeouts:l,userAgent:a,headers:e.headers,queryParameters:x,hosts:u.map(function(D){return rt(D)}),read:function(D,j){var B=te(j,g.timeouts.read),R=function(){return Ie(g,g.hosts.filter(function(Y){return(Y.accept&me.Read)!=0}),D,B)};if((B.cacheable!==void 0?B.cacheable:D.cacheable)!==!0)return R();var V={request:D,mappedRequestOptions:B,transporter:{queryParameters:g.queryParameters,headers:g.headers}};return g.responsesCache.get(V,function(){return g.requestsCache.get(V,function(){return g.requestsCache.set(V,R()).then(function(Y){return Promise.all([g.requestsCache.delete(V),Y])},function(Y){return Promise.all([g.requestsCache.delete(V),Promise.reject(Y)])}).then(function(Y){var ue=q(Y,2);return ue[0],ue[1]})})},{miss:function(Y){return g.responsesCache.set(V,Y)}})},write:function(D,j){return Ie(g,g.hosts.filter(function(B){return(B.accept&me.Write)!=0}),D,te(j,g.timeouts.write))}};return g}function pe(e){var t={value:"Algolia for JavaScript (".concat(e,")"),add:function(n){var r="; ".concat(n.segment).concat(n.version!==void 0?" (".concat(n.version,")"):"");return t.value.indexOf(r)===-1&&(t.value="".concat(t.value).concat(r)),t}};return t}function yt(e,t,n){var r=We(n),o="".concat(e.protocol,"://").concat(e.url,"/").concat(t.charAt(0)==="/"?t.substr(1):t);return r.length&&(o+="?".concat(r)),o}function We(e){return Object.keys(e).map(function(t){return w("%s=%s",t,(n=e[t],Object.prototype.toString.call(n)==="[object Object]"||Object.prototype.toString.call(n)==="[object Array]"?JSON.stringify(e[t]):e[t]));var n}).join("&")}function Fe(e){return e.map(function(t){return be(t)})}function be(e){var t=e.request.headers["x-algolia-api-key"]?{"x-algolia-api-key":"*****"}:{};return i(i({},e),{},{request:i(i({},e.request),{},{headers:i(i({},e.request.headers),t)})})}var bt=function(e){return function(t,n){return e.transporter.write({method:k,path:"2/abtests",data:t},n)}},vt=function(e){return function(t,n){return e.transporter.write({method:ae,path:w("2/abtests/%s",t)},n)}},wt=function(e){return function(t,n){return e.transporter.read({method:U,path:w("2/abtests/%s",t)},n)}},xt=function(e){return function(t){return e.transporter.read({method:U,path:"2/abtests"},t)}},Je=function(e){return function(t,n){return e.transporter.write({method:k,path:w("2/abtests/%s/stop",t)},n)}},ot=function(e){return function(t){return e.transporter.read({method:U,path:"1/strategies/personalization"},t)}},it=function(e){return function(t,n){return e.transporter.write({method:k,path:"1/strategies/personalization",data:t},n)}};function He(e){return function t(n){return e.request(n).then(function(r){if(e.batch!==void 0&&e.batch(r.hits),!e.shouldStop(r))return r.cursor?t({cursor:r.cursor}):t({page:(n.page||0)+1})})}({})}var De=function(e){return function(t,n){var r=n||{},o=r.queryParameters,s=b(r,["queryParameters"]),l=i({acl:t},o!==void 0?{queryParameters:o}:{});return I(e.transporter.write({method:k,path:"1/keys",data:l},s),function(a,u){return M(function(x){return qe(e)(a.key,u).catch(function(g){if(g.status!==404)throw g;return x()})})})}},It=function(e){return function(t,n,r){var o=te(r);return o.queryParameters["X-Algolia-User-ID"]=t,e.transporter.write({method:k,path:"1/clusters/mapping",data:{cluster:n}},o)}},St=function(e){return function(t,n,r){return e.transporter.write({method:k,path:"1/clusters/mapping/batch",data:{users:t,cluster:n}},r)}},Et=function(e){return function(t,n){return I(e.transporter.write({method:k,path:w("/1/dictionaries/%s/batch",t),data:{clearExistingDictionaryEntries:!0,requests:{action:"addEntry",body:[]}}},n),function(r,o){return W(e)(r.taskID,o)})}},Le=function(e){return function(t,n,r){return I(e.transporter.write({method:k,path:w("1/indexes/%s/operation",t),data:{operation:"copy",destination:n}},r),function(o,s){return C(e)(t,{methods:{waitTask:ne}}).waitTask(o.taskID,s)})}},Ot=function(e){return function(t,n,r){return Le(e)(t,n,i(i({},r),{},{scope:[Nt.Rules]}))}},Pt=function(e){return function(t,n,r){return Le(e)(t,n,i(i({},r),{},{scope:[Nt.Settings]}))}},kt=function(e){return function(t,n,r){return Le(e)(t,n,i(i({},r),{},{scope:[Nt.Synonyms]}))}},Ke=function(e){return function(t,n){return t.method===U?e.transporter.read(t,n):e.transporter.write(t,n)}},Qe=function(e){return function(t,n){return I(e.transporter.write({method:ae,path:w("1/keys/%s",t)},n),function(r,o){return M(function(s){return qe(e)(t,o).then(s).catch(function(l){if(l.status!==404)throw l})})})}},Ct=function(e){return function(t,n,r){var o=n.map(function(s){return{action:"deleteEntry",body:{objectID:s}}});return I(e.transporter.write({method:k,path:w("/1/dictionaries/%s/batch",t),data:{clearExistingDictionaryEntries:!1,requests:o}},r),function(s,l){return W(e)(s.taskID,l)})}},qe=function(e){return function(t,n){return e.transporter.read({method:U,path:w("1/keys/%s",t)},n)}},at=function(e){return function(t,n){return e.transporter.read({method:U,path:w("1/task/%s",t.toString())},n)}},c=function(e){return function(t){return e.transporter.read({method:U,path:"/1/dictionaries/*/settings"},t)}},m=function(e){return function(t){return e.transporter.read({method:U,path:"1/logs"},t)}},E=function(e){return function(t){return e.transporter.read({method:U,path:"1/clusters/mapping/top"},t)}},O=function(e){return function(t,n){return e.transporter.read({method:U,path:w("1/clusters/mapping/%s",t)},n)}},d=function(e){return function(t){var n=t||{},r=n.retrieveMappings,o=b(n,["retrieveMappings"]);return r===!0&&(o.getClusters=!0),e.transporter.read({method:U,path:"1/clusters/mapping/pending"},o)}},C=function(e){return function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r={transporter:e.transporter,appId:e.appId,indexName:t};return P(r,n.methods)}},y=function(e){return function(t){return e.transporter.read({method:U,path:"1/keys"},t)}},p=function(e){return function(t){return e.transporter.read({method:U,path:"1/clusters"},t)}},S=function(e){return function(t){return e.transporter.read({method:U,path:"1/indexes"},t)}},A=function(e){return function(t){return e.transporter.read({method:U,path:"1/clusters/mapping"},t)}},h=function(e){return function(t,n,r){return I(e.transporter.write({method:k,path:w("1/indexes/%s/operation",t),data:{operation:"move",destination:n}},r),function(o,s){return C(e)(t,{methods:{waitTask:ne}}).waitTask(o.taskID,s)})}},f=function(e){return function(t,n){return I(e.transporter.write({method:k,path:"1/indexes/*/batch",data:{requests:t}},n),function(r,o){return Promise.all(Object.keys(r.taskID).map(function(s){return C(e)(s,{methods:{waitTask:ne}}).waitTask(r.taskID[s],o)}))})}},T=function(e){return function(t,n){return e.transporter.read({method:k,path:"1/indexes/*/objects",data:{requests:t}},n)}},L=function(e){return function(t,n){var r=t.map(function(o){return i(i({},o),{},{params:We(o.params||{})})});return e.transporter.read({method:k,path:"1/indexes/*/queries",data:{requests:r},cacheable:!0},n)}},H=function(e){return function(t,n){return Promise.all(t.map(function(r){var o=r.params,s=o.facetName,l=o.facetQuery,a=b(o,["facetName","facetQuery"]);return C(e)(r.indexName,{methods:{searchForFacetValues:$t}}).searchForFacetValues(s,l,i(i({},n),a))}))}},G=function(e){return function(t,n){var r=te(n);return r.queryParameters["X-Algolia-User-ID"]=t,e.transporter.write({method:ae,path:"1/clusters/mapping"},r)}},re=function(e){return function(t,n,r){var o=n.map(function(s){return{action:"addEntry",body:s}});return I(e.transporter.write({method:k,path:w("/1/dictionaries/%s/batch",t),data:{clearExistingDictionaryEntries:!0,requests:o}},r),function(s,l){return W(e)(s.taskID,l)})}},he=function(e){return function(t,n){return I(e.transporter.write({method:k,path:w("1/keys/%s/restore",t)},n),function(r,o){return M(function(s){return qe(e)(t,o).catch(function(l){if(l.status!==404)throw l;return s()})})})}},se=function(e){return function(t,n,r){var o=n.map(function(s){return{action:"addEntry",body:s}});return I(e.transporter.write({method:k,path:w("/1/dictionaries/%s/batch",t),data:{clearExistingDictionaryEntries:!1,requests:o}},r),function(s,l){return W(e)(s.taskID,l)})}},ce=function(e){return function(t,n,r){return e.transporter.read({method:k,path:w("/1/dictionaries/%s/search",t),data:{query:n},cacheable:!0},r)}},$=function(e){return function(t,n){return e.transporter.read({method:k,path:"1/clusters/mapping/search",data:{query:t}},n)}},de=function(e){return function(t,n){return I(e.transporter.write({method:Be,path:"/1/dictionaries/*/settings",data:t},n),function(r,o){return W(e)(r.taskID,o)})}},fe=function(e){return function(t,n){var r=Object.assign({},n),o=n||{},s=o.queryParameters,l=b(o,["queryParameters"]),a=s?{queryParameters:s}:{},u=["acl","indexes","referers","restrictSources","queryParameters","description","maxQueriesPerIPPerHour","maxHitsPerQuery"];return I(e.transporter.write({method:Be,path:w("1/keys/%s",t),data:a},l),function(x,g){return M(function(D){return qe(e)(t,g).then(function(j){return function(B){return Object.keys(r).filter(function(R){return u.indexOf(R)!==-1}).every(function(R){if(Array.isArray(B[R])&&Array.isArray(r[R])){var V=B[R];return V.length===r[R].length&&V.every(function(Y,ue){return Y===r[R][ue]})}return B[R]===r[R]})}(j)?Promise.resolve():D()})})})}},W=function(e){return function(t,n){return M(function(r){return at(e)(t,n).then(function(o){return o.status!=="published"?r():void 0})})}},ve=function(e){return function(t,n){return I(e.transporter.write({method:k,path:w("1/indexes/%s/batch",e.indexName),data:{requests:t}},n),function(r,o){return ne(e)(r.taskID,o)})}},Se=function(e){return function(t){return He(i(i({shouldStop:function(n){return n.cursor===void 0}},t),{},{request:function(n){return e.transporter.read({method:k,path:w("1/indexes/%s/browse",e.indexName),data:n},t)}}))}},Ee=function(e){return function(t){var n=i({hitsPerPage:1e3},t);return He(i(i({shouldStop:function(r){return r.hits.length<n.hitsPerPage}},n),{},{request:function(r){return Mt(e)("",i(i({},n),r)).then(function(o){return i(i({},o),{},{hits:o.hits.map(function(s){return delete s._highlightResult,s})})})}}))}},we=function(e){return function(t){var n=i({hitsPerPage:1e3},t);return He(i(i({shouldStop:function(r){return r.hits.length<n.hitsPerPage}},n),{},{request:function(r){return Bt(e)("",i(i({},n),r)).then(function(o){return i(i({},o),{},{hits:o.hits.map(function(s){return delete s._highlightResult,s})})})}}))}},xe=function(e){return function(t,n,r){var o=r||{},s=o.batchSize,l=b(o,["batchSize"]),a={taskIDs:[],objectIDs:[]};return I(function u(){var x,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,D=[];for(x=g;x<t.length&&(D.push(t[x]),D.length!==(s||1e3));x++);return D.length===0?Promise.resolve(a):ve(e)(D.map(function(j){return{action:n,body:j}}),l).then(function(j){return a.objectIDs=a.objectIDs.concat(j.objectIDs),a.taskIDs.push(j.taskID),x++,u(x)})}(),function(u,x){return Promise.all(u.taskIDs.map(function(g){return ne(e)(g,x)}))})}},Ne=function(e){return function(t){return I(e.transporter.write({method:k,path:w("1/indexes/%s/clear",e.indexName)},t),function(n,r){return ne(e)(n.taskID,r)})}},Re=function(e){return function(t){var n=t||{},r=n.forwardToReplicas,o=te(b(n,["forwardToReplicas"]));return r&&(o.queryParameters.forwardToReplicas=1),I(e.transporter.write({method:k,path:w("1/indexes/%s/rules/clear",e.indexName)},o),function(s,l){return ne(e)(s.taskID,l)})}},Oe=function(e){return function(t){var n=t||{},r=n.forwardToReplicas,o=te(b(n,["forwardToReplicas"]));return r&&(o.queryParameters.forwardToReplicas=1),I(e.transporter.write({method:k,path:w("1/indexes/%s/synonyms/clear",e.indexName)},o),function(s,l){return ne(e)(s.taskID,l)})}},Pe=function(e){return function(t,n){return I(e.transporter.write({method:k,path:w("1/indexes/%s/deleteByQuery",e.indexName),data:t},n),function(r,o){return ne(e)(r.taskID,o)})}},st=function(e){return function(t){return I(e.transporter.write({method:ae,path:w("1/indexes/%s",e.indexName)},t),function(n,r){return ne(e)(n.taskID,r)})}},ct=function(e){return function(t,n){return I(Ye(e)([t],n).then(function(r){return{taskID:r.taskIDs[0]}}),function(r,o){return ne(e)(r.taskID,o)})}},Ye=function(e){return function(t,n){var r=t.map(function(o){return{objectID:o}});return xe(e)(r,Ue.DeleteObject,n)}},ut=function(e){return function(t,n){var r=n||{},o=r.forwardToReplicas,s=te(b(r,["forwardToReplicas"]));return o&&(s.queryParameters.forwardToReplicas=1),I(e.transporter.write({method:ae,path:w("1/indexes/%s/rules/%s",e.indexName,t)},s),function(l,a){return ne(e)(l.taskID,a)})}},lt=function(e){return function(t,n){var r=n||{},o=r.forwardToReplicas,s=te(b(r,["forwardToReplicas"]));return o&&(s.queryParameters.forwardToReplicas=1),I(e.transporter.write({method:ae,path:w("1/indexes/%s/synonyms/%s",e.indexName,t)},s),function(l,a){return ne(e)(l.taskID,a)})}},dt=function(e){return function(t){return $e(e)(t).then(function(){return!0}).catch(function(n){if(n.status!==404)throw n;return!1})}},ft=function(e){return function(t,n,r){return e.transporter.read({method:k,path:w("1/answers/%s/prediction",e.indexName),data:{query:t,queryLanguages:n},cacheable:!0},r)}},pt=function(e){return function(t,n){var r=n||{},o=r.query,s=r.paginate,l=b(r,["query","paginate"]),a=0;return function u(){return _t(e)(o||"",i(i({},l),{},{page:a})).then(function(x){for(var g=0,D=Object.entries(x.hits);g<D.length;g++){var j=q(D[g],2),B=j[0],R=j[1];if(t(R))return{object:R,position:parseInt(B,10),page:a}}if(a++,s===!1||a>=x.nbPages)throw{name:"ObjectNotFoundError",message:"Object not found."};return u()})}()}},K=function(e){return function(t,n){return e.transporter.read({method:U,path:w("1/indexes/%s/%s",e.indexName,t)},n)}},Xe=function(){return function(e,t){for(var n=0,r=Object.entries(e.hits);n<r.length;n++){var o=q(r[n],2),s=o[0];if(o[1].objectID===t)return parseInt(s,10)}return-1}},_e=function(e){return function(t,n){var r=n||{},o=r.attributesToRetrieve,s=b(r,["attributesToRetrieve"]),l=t.map(function(a){return i({indexName:e.indexName,objectID:a},o?{attributesToRetrieve:o}:{})});return e.transporter.read({method:k,path:"1/indexes/*/objects",data:{requests:l}},s)}},ke=function(e){return function(t,n){return e.transporter.read({method:U,path:w("1/indexes/%s/rules/%s",e.indexName,t)},n)}},$e=function(e){return function(t){return e.transporter.read({method:U,path:w("1/indexes/%s/settings",e.indexName),data:{getVersion:2}},t)}},Tt=function(e){return function(t,n){return e.transporter.read({method:U,path:w("1/indexes/%s/synonyms/%s",e.indexName,t)},n)}},At=function(e){return function(t,n){return I(mt(e)([t],n).then(function(r){return{objectID:r.objectIDs[0],taskID:r.taskIDs[0]}}),function(r,o){return ne(e)(r.taskID,o)})}},mt=function(e){return function(t,n){var r=n||{},o=r.createIfNotExists,s=b(r,["createIfNotExists"]),l=o?Ue.PartialUpdateObject:Ue.PartialUpdateObjectNoCreate;return xe(e)(t,l,s)}},jt=function(e){return function(t,n){var r=n||{},o=r.safe,s=r.autoGenerateObjectIDIfNotExist,l=r.batchSize,a=b(r,["safe","autoGenerateObjectIDIfNotExist","batchSize"]),u=function(R,V,Y,ue){return I(e.transporter.write({method:k,path:w("1/indexes/%s/operation",R),data:{operation:Y,destination:V}},ue),function(Ze,le){return ne(e)(Ze.taskID,le)})},x=Math.random().toString(36).substring(7),g="".concat(e.indexName,"_tmp_").concat(x),D=Dt({appId:e.appId,transporter:e.transporter,indexName:g}),j=[],B=u(e.indexName,g,"copy",i(i({},a),{},{scope:["settings","synonyms","rules"]}));return j.push(B),I((o?B.wait(a):B).then(function(){var R=D(t,i(i({},a),{},{autoGenerateObjectIDIfNotExist:s,batchSize:l}));return j.push(R),o?R.wait(a):R}).then(function(){var R=u(g,e.indexName,"move",a);return j.push(R),o?R.wait(a):R}).then(function(){return Promise.all(j)}).then(function(R){var V=q(R,3),Y=V[0],ue=V[1],Ze=V[2];return{objectIDs:ue.objectIDs,taskIDs:[Y.taskID].concat(z(ue.taskIDs),[Ze.taskID])}}),function(R,V){return Promise.all(j.map(function(Y){return Y.wait(V)}))})}},ze=function(e){return function(t,n){return Lt(e)(t,i(i({},n),{},{clearExistingRules:!0}))}},Ut=function(e){return function(t,n){return qt(e)(t,i(i({},n),{},{clearExistingSynonyms:!0}))}},Vt=function(e){return function(t,n){return I(Dt(e)([t],n).then(function(r){return{objectID:r.objectIDs[0],taskID:r.taskIDs[0]}}),function(r,o){return ne(e)(r.taskID,o)})}},Dt=function(e){return function(t,n){var r=n||{},o=r.autoGenerateObjectIDIfNotExist,s=b(r,["autoGenerateObjectIDIfNotExist"]),l=o?Ue.AddObject:Ue.UpdateObject;if(l===Ue.UpdateObject){var a=!0,u=!1,x=void 0;try{for(var g,D=t[Symbol.iterator]();!(a=(g=D.next()).done);a=!0)if(g.value.objectID===void 0)return I(Promise.reject({name:"MissingObjectIDError",message:"All objects must have an unique objectID (like a primary key) to be valid. Algolia is also able to generate objectIDs automatically but *it's not recommended*. To do it, use the `{'autoGenerateObjectIDIfNotExist': true}` option."}))}catch(j){u=!0,x=j}finally{try{a||D.return==null||D.return()}finally{if(u)throw x}}}return xe(e)(t,l,s)}},Gt=function(e){return function(t,n){return Lt(e)([t],n)}},Lt=function(e){return function(t,n){var r=n||{},o=r.forwardToReplicas,s=r.clearExistingRules,l=te(b(r,["forwardToReplicas","clearExistingRules"]));return o&&(l.queryParameters.forwardToReplicas=1),s&&(l.queryParameters.clearExistingRules=1),I(e.transporter.write({method:k,path:w("1/indexes/%s/rules/batch",e.indexName),data:t},l),function(a,u){return ne(e)(a.taskID,u)})}},Wt=function(e){return function(t,n){return qt(e)([t],n)}},qt=function(e){return function(t,n){var r=n||{},o=r.forwardToReplicas,s=r.clearExistingSynonyms,l=r.replaceExistingSynonyms,a=te(b(r,["forwardToReplicas","clearExistingSynonyms","replaceExistingSynonyms"]));return o&&(a.queryParameters.forwardToReplicas=1),(l||s)&&(a.queryParameters.replaceExistingSynonyms=1),I(e.transporter.write({method:k,path:w("1/indexes/%s/synonyms/batch",e.indexName),data:t},a),function(u,x){return ne(e)(u.taskID,x)})}},_t=function(e){return function(t,n){return e.transporter.read({method:k,path:w("1/indexes/%s/query",e.indexName),data:{query:t},cacheable:!0},n)}},$t=function(e){return function(t,n,r){return e.transporter.read({method:k,path:w("1/indexes/%s/facets/%s/query",e.indexName,t),data:{facetQuery:n},cacheable:!0},r)}},Mt=function(e){return function(t,n){return e.transporter.read({method:k,path:w("1/indexes/%s/rules/search",e.indexName),data:{query:t}},n)}},Bt=function(e){return function(t,n){return e.transporter.read({method:k,path:w("1/indexes/%s/synonyms/search",e.indexName),data:{query:t}},n)}},Jt=function(e){return function(t,n){var r=n||{},o=r.forwardToReplicas,s=te(b(r,["forwardToReplicas"]));return o&&(s.queryParameters.forwardToReplicas=1),I(e.transporter.write({method:Be,path:w("1/indexes/%s/settings",e.indexName),data:t},s),function(l,a){return ne(e)(l.taskID,a)})}},ne=function(e){return function(t,n){return M(function(r){return function(o){return function(s,l){return o.transporter.read({method:U,path:w("1/indexes/%s/task/%s",o.indexName,s.toString())},l)}}(e)(t,n).then(function(o){return o.status!=="published"?r():void 0})})}},Ue={AddObject:"addObject",UpdateObject:"updateObject",PartialUpdateObject:"partialUpdateObject",PartialUpdateObjectNoCreate:"partialUpdateObjectNoCreate",DeleteObject:"deleteObject"},Nt={Settings:"settings",Synonyms:"synonyms",Rules:"rules"},Kt=1,Qt=2,Yt=3,ht=function(e){return function(t,n){var r=t.map(function(o){return i(i({},o),{},{threshold:o.threshold||0})});return e.transporter.read({method:k,path:"1/indexes/*/recommendations",data:{requests:r},cacheable:!0},n)}},Xt=function(e){return function(t,n){return ht(e)(t.map(function(r){return i(i({},r),{},{fallbackParameters:{},model:"bought-together"})}),n)}},Zt=function(e){return function(t,n){return ht(e)(t.map(function(r){return i(i({},r),{},{model:"related-products"})}),n)}},en=function(e){return function(t,n){var r=t.map(function(o){return i(i({},o),{},{model:"trending-facets",threshold:o.threshold||0})});return e.transporter.read({method:k,path:"1/indexes/*/recommendations",data:{requests:r},cacheable:!0},n)}},tn=function(e){return function(t,n){var r=t.map(function(o){return i(i({},o),{},{model:"trending-items",threshold:o.threshold||0})});return e.transporter.read({method:k,path:"1/indexes/*/recommendations",data:{requests:r},cacheable:!0},n)}},nn=function(e){return function(t,n){return ht(e)(t.map(function(r){return i(i({},r),{},{model:"looking-similar"})}),n)}},rn=function(e){return function(t,n){var r=t.map(function(o){return i(i({},o),{},{model:"recommended-for-you",threshold:o.threshold||0})});return e.transporter.read({method:k,path:"1/indexes/*/recommendations",data:{requests:r},cacheable:!0},n)}};function Ft(e,t,n){var r,o={appId:e,apiKey:t,timeouts:{connect:1,read:2,write:30},requester:{send:function(a){return new Promise(function(u){var x=new XMLHttpRequest;x.open(a.method,a.url,!0),Object.keys(a.headers).forEach(function(B){return x.setRequestHeader(B,a.headers[B])});var g,D=function(B,R){return setTimeout(function(){x.abort(),u({status:0,content:R,isTimedOut:!0})},1e3*B)},j=D(a.connectTimeout,"Connection timeout");x.onreadystatechange=function(){x.readyState>x.OPENED&&g===void 0&&(clearTimeout(j),g=D(a.responseTimeout,"Socket timeout"))},x.onerror=function(){x.status===0&&(clearTimeout(j),clearTimeout(g),u({content:x.responseText||"Network request failed",status:x.status,isTimedOut:!1}))},x.onload=function(){clearTimeout(j),clearTimeout(g),u({content:x.responseText,status:x.status,isTimedOut:!1})},x.send(a.data)})}},logger:(r=Yt,{debug:function(a,u){return Kt>=r&&console.debug(a,u),Promise.resolve()},info:function(a,u){return Qt>=r&&console.info(a,u),Promise.resolve()},error:function(a,u){return console.error(a,u),Promise.resolve()}}),responsesCache:Z(),requestsCache:Z({serializable:!1}),hostsCache:v({caches:[F({key:"".concat("4.24.0","-").concat(e)}),Z()]}),userAgent:pe("4.24.0").add({segment:"Browser"})},s=i(i({},o),n),l=function(){return function(a){return function(u){var x=u.region||"us",g=ie(J.WithinHeaders,u.appId,u.apiKey),D=ye(i(i({hosts:[{url:"personalization.".concat(x,".algolia.com")}]},u),{},{headers:i(i(i({},g.headers()),{"content-type":"application/json"}),u.headers),queryParameters:i(i({},g.queryParameters()),u.queryParameters)}));return P({appId:u.appId,transporter:D},u.methods)}(i(i(i({},o),a),{},{methods:{getPersonalizationStrategy:ot,setPersonalizationStrategy:it}}))}};return function(a){var u=a.appId,x=ie(a.authMode!==void 0?a.authMode:J.WithinHeaders,u,a.apiKey),g=ye(i(i({hosts:[{url:"".concat(u,"-dsn.algolia.net"),accept:me.Read},{url:"".concat(u,".algolia.net"),accept:me.Write}].concat(ee([{url:"".concat(u,"-1.algolianet.com")},{url:"".concat(u,"-2.algolianet.com")},{url:"".concat(u,"-3.algolianet.com")}]))},a),{},{headers:i(i(i({},x.headers()),{"content-type":"application/x-www-form-urlencoded"}),a.headers),queryParameters:i(i({},x.queryParameters()),a.queryParameters)}));return P({transporter:g,appId:u,addAlgoliaAgent:function(D,j){g.userAgent.add({segment:D,version:j})},clearCache:function(){return Promise.all([g.requestsCache.clear(),g.responsesCache.clear()]).then(function(){})}},a.methods)}(i(i({},s),{},{methods:{search:L,searchForFacetValues:H,multipleBatch:f,multipleGetObjects:T,multipleQueries:L,copyIndex:Le,copySettings:Pt,copySynonyms:kt,copyRules:Ot,moveIndex:h,listIndices:S,getLogs:m,listClusters:p,multipleSearchForFacetValues:H,getApiKey:qe,addApiKey:De,listApiKeys:y,updateApiKey:fe,deleteApiKey:Qe,restoreApiKey:he,assignUserID:It,assignUserIDs:St,getUserID:O,searchUserIDs:$,listUserIDs:A,getTopUserIDs:E,removeUserID:G,hasPendingMappings:d,clearDictionaryEntries:Et,deleteDictionaryEntries:Ct,getDictionarySettings:c,getAppTask:at,replaceDictionaryEntries:re,saveDictionaryEntries:se,searchDictionaryEntries:ce,setDictionarySettings:de,waitAppTask:W,customRequest:Ke,initIndex:function(a){return function(u){return C(a)(u,{methods:{batch:ve,delete:st,findAnswers:ft,getObject:K,getObjects:_e,saveObject:Vt,saveObjects:Dt,search:_t,searchForFacetValues:$t,waitTask:ne,setSettings:Jt,getSettings:$e,partialUpdateObject:At,partialUpdateObjects:mt,deleteObject:ct,deleteObjects:Ye,deleteBy:Pe,clearObjects:Ne,browseObjects:Se,getObjectPosition:Xe,findObject:pt,exists:dt,saveSynonym:Wt,saveSynonyms:qt,getSynonym:Tt,searchSynonyms:Bt,browseSynonyms:we,deleteSynonym:lt,clearSynonyms:Oe,replaceAllObjects:jt,replaceAllSynonyms:Ut,searchRules:Mt,getRule:ke,deleteRule:ut,saveRule:Gt,saveRules:Lt,replaceAllRules:ze,browseRules:Ee,clearRules:Re}})}},initAnalytics:function(){return function(a){return function(u){var x=u.region||"us",g=ie(J.WithinHeaders,u.appId,u.apiKey),D=ye(i(i({hosts:[{url:"analytics.".concat(x,".algolia.com")}]},u),{},{headers:i(i(i({},g.headers()),{"content-type":"application/json"}),u.headers),queryParameters:i(i({},g.queryParameters()),u.queryParameters)}));return P({appId:u.appId,transporter:D},u.methods)}(i(i(i({},o),a),{},{methods:{addABTest:bt,getABTest:wt,getABTests:xt,stopABTest:Je,deleteABTest:vt}}))}},initPersonalization:l,initRecommendation:function(){return function(a){return s.logger.info("The `initRecommendation` method is deprecated. Use `initPersonalization` instead."),l()(a)}},getRecommendations:ht,getFrequentlyBoughtTogether:Xt,getLookingSimilar:nn,getRecommendedForYou:rn,getRelatedProducts:Zt,getTrendingFacets:en,getTrendingItems:tn}}))}return Ft.version="4.24.0",Ft})})(zt);var cn=zt.exports;const un=sn(cn),ln="https://api.opensea.io/api/v2";async function nt(_,X,Q="ethereum",N={}){const i={"X-API-KEY":X,accept:"application/json"};N.method==="POST"&&N.body&&(i["content-type"]="application/json");try{const b=await fetch(`${ln}${_}`,{headers:i,...N});if(!b.ok){let q=b.statusText;try{const z=await b.json();q=z.message||(typeof z=="string"?z:JSON.stringify(z)),z.errors&&(q=z.errors.join(", "))}catch{}throw console.error(`OpenSea API Error (${b.status}): ${q} for endpoint ${_}`),new Error(`OpenSea API request failed: ${b.status} - ${q}`)}return b.status===204?null:await b.json()}catch(b){throw console.error(`Error fetching from OpenSea endpoint ${_}:`,b),b}}async function dn(_,X,Q="ethereum"){try{const N=await nt(`/chain/${Q}/contract/${_}`,X,Q);if(N&&N.collection)return N.collection;throw new Error("Could not retrieve collection slug from contract data.")}catch(N){throw console.error(`Error fetching collection slug for ${_}:`,N),N}}async function fn(_,X,Q="ethereum",N=null,i=50){if(!_)throw console.error("Collection slug and API key are required to fetch activity."),new Error("Collection slug and API key are required.");try{const b=Math.min(i,50);let q=`/events/collection/${_}?limit=${b}`;return N&&(q+=`&event_type=${N}`),(await nt(q,X,Q)).asset_events||[]}catch(b){throw console.error(`Error fetching activity for slug ${_}:`,b),b}}async function pn(_,X,Q="ethereum",N=200){if(!_)throw console.error("Collection slug and API key are required to fetch collectors."),new Error("Collection slug and API key are required.");console.warn("Fetching collectors for "+_+". This provides a sample based on the first "+N+" NFTs and may not be exhaustive for large collections.");try{const b=(await nt(`/collection/${_}/nfts?limit=${Math.min(N,200)}`,X,Q)).nfts||[];if(b.length===0)return{collectors:[],totalScanned:0};const q={};return b.forEach(F=>{if(F.owners&&F.owners.length>0){const v=F.owners[0].address;v&&(q[v]=(q[v]||0)+1)}}),{collectors:Object.entries(q).map(([F,v])=>({address:F,count:v})).sort((F,v)=>v.count-F.count),totalScanned:b.length}}catch(i){throw console.error(`Error fetching collectors for slug ${_}:`,i),i}}async function mn(_,X,Q="ethereum",N=100,i=20,b=null,q=10,z=0){var ie;const F=[];let v=null,Z=0;do{const M=v?`/listings/collection/${_}/all?limit=${Math.min(N,100)}&cursor=${encodeURIComponent(v)}`:`/listings/collection/${_}/all?limit=${Math.min(N,100)}`,I=await nt(M,X,Q);if((ie=I==null?void 0:I.listings)!=null&&ie.length){let ee=I.listings;Array.isArray(b)&&b.length&&(ee=ee.filter(P=>{const w=P.order_source||P.order_source_name||P.order_provider||"";return w?b.some(J=>w.toLowerCase().includes(J)):!0})),F.push(...ee)}v=(I==null?void 0:I.next)||null,Z+=1,z&&z>0&&await new Promise(ee=>setTimeout(ee,z))}while(v&&Z<i);if(q&&q>0){const M=new Map,I=P=>{var J;const w=(J=P.price)==null?void 0:J.current;return w?`${w.value}-${w.currency??""}-${w.decimals??""}`:null};for(const P of F){const w=I(P);w&&M.set(w,(M.get(w)||0)+1)}const ee=new Set([...M.entries()].filter(([,P])=>P>=q).map(([P])=>P));if(ee.size)return F.filter(P=>!ee.has(I(P)))}return F}async function hn(_,X,Q="ethereum",N=100,i=20,b=null,q=0){var Z;const z=[];let F=null,v=0;do{const ie=F?`/listings/collection/${_}/best?limit=${Math.min(N,100)}&cursor=${encodeURIComponent(F)}`:`/listings/collection/${_}/best?limit=${Math.min(N,100)}`,M=await nt(ie,X,Q);if((Z=M==null?void 0:M.listings)!=null&&Z.length){let I=M.listings;Array.isArray(b)&&b.length&&(I=I.filter(ee=>{const P=ee.order_source||ee.order_source_name||ee.order_provider||"";return P?b.some(w=>P.toLowerCase().includes(w)):!0})),z.push(...I)}F=(M==null?void 0:M.next)||null,v+=1,q&&await new Promise(I=>setTimeout(I,q))}while(F&&v<i);return z}async function Ht(_,X,Q="ethereum",N=null,i=0){var z,F,v,Z,ie,M,I,ee;try{const P=await hn(_,X,Q,100,20,N,i);if(P&&P.length)return P}catch(P){console.warn("fetchBestListingsForCollection failed, falling back to /all:",P.message||P)}const b=await mn(_,X,Q,100,20,N,0,i),q=new Map;for(const P of b){const w=(Z=(v=(F=(z=P==null?void 0:P.protocol_data)==null?void 0:z.parameters)==null?void 0:F.offer)==null?void 0:v[0])==null?void 0:Z.identifierOrCriteria;if(w==null)continue;const J=w.toString(),te=q.get(J);if(!te)q.set(J,P);else{const me=(M=(ie=P.price)==null?void 0:ie.current)!=null&&M.value?BigInt(P.price.current.value):BigInt(0),Ae=(ee=(I=te.price)==null?void 0:I.current)!=null&&ee.value?BigInt(te.price.current.value):BigInt(0);me<Ae&&q.set(J,P)}}return[...q.values()]}(function(){const i=un("8I4QUDIYPJ","0b78c3d3ea56c86c7d766052bad49abe").initIndex("songs"),b="533037544c3044d9be47567bbb711433",q="0x19b703f65aa7e1e775bd06c2aa0d0d08c80f1c45",z=["opensea","blur"];let F=null;console.log("OpenSea ENV Vars:",{key:"Loaded",contract:"Loaded"});const v=OpenSeadragon({id:"viewer",prefixUrl:"https://cdnjs.cloudflare.com/ajax/libs/openseadragon/4.1.0/images/",showNavigator:!1,showNavigationControl:!1,showHomeControl:!1,showZoomControl:!1,showFullPageControl:!1,constrainDuringPan:!0,visibilityRatio:1,minZoomImageRatio:.8,defaultZoomLevel:.8,springStiffness:5,animationTime:.7,homeFitBounds:!0,tileSources:{height:20520,width:36960,tileSize:256,minLevel:0,maxLevel:7,getTileUrl:function(c,m,E){return`https://songadaygallery.blob.core.windows.net/dzi/level_${c}/tiles/${m}_${E}.jpg`}}}),Z=77,ie=76,M=36960/Z,I=20520/ie,ee=document.createElement("div");ee.id="gif-container",v.canvas.appendChild(ee);const P=document.createElement("div");P.className="highlight-box",v.canvas.appendChild(P);let w=null,J=new Map,te=!0;function me(c){if(!c)return null;const m=v.viewport.pointFromPixel(c),E=v.viewport.viewportToImageCoordinates(m),O=Math.floor(E.x/M),d=Math.floor(E.y/I);if(O>=0&&O<Z&&d>=0&&d<ie){const C=d*Z+O+1;if(C<=5852)return{id:C,rect:new OpenSeadragon.Rect(O*M,d*I,M,I)}}return null}function Ae(){const c=v.viewport.getBounds(),m=v.viewport.viewportToImageRectangle(c),E=Math.max(0,Math.floor(m.x/M)),O=Math.max(0,Math.floor(m.y/I)),d=Math.min(Z-1,Math.ceil((m.x+m.width)/M)),C=Math.min(ie-1,Math.ceil((m.y+m.height)/I)),y=[];for(let p=O;p<=C;p++)for(let S=E;S<=d;S++){const A=p*Z+S+1;A<=5852&&y.push({id:A,rect:new OpenSeadragon.Rect(S*M,p*I,M,I)})}return y}function Ge(){if(!te){J.forEach(d=>d.remove()),J.clear();return}const c=v.viewport.getZoom(),m=v.viewport.getMaxZoom();if(c>m*.2){const d=Ae(),C=new Set;d.forEach(y=>{if(C.add(y.id),!J.has(y.id)){const h=document.createElement("div");h.className="gif-overlay";const f=document.createElement("img");f.src=`https://songadaygallery.blob.core.windows.net/dzi/${y.id}.gif`,h.appendChild(f),ee.appendChild(h),J.set(y.id,h)}const p=J.get(y.id),S=v.viewport.imageToViewportRectangle(y.rect),A=v.viewport.viewportToViewerElementRectangle(S);p.style.left=A.x+"px",p.style.top=A.y+"px",p.style.width=A.width+"px",p.style.height=A.height+"px",p.style.display="block"});for(const[y,p]of J)C.has(y)||(p.remove(),J.delete(y))}else J.forEach(d=>d.remove()),J.clear()}function je(c){const m=me(c);if(m){w=m.id;const E=v.viewport.imageToViewportRectangle(m.rect),O=v.viewport.viewportToViewerElementRectangle(E);P.style.left=O.x+"px",P.style.top=O.y+"px",P.style.width=O.width+"px",P.style.height=O.height+"px",P.style.display="block"}else w=null,P.style.display="none"}v.addHandler("animation",function(){Ge(),w&&v.lastMousePosition&&je(v.lastMousePosition)}),v.addHandler("update-viewport",Ge),new OpenSeadragon.MouseTracker({element:v.canvas,moveHandler:c=>{c.buttons||je(c.position)},overHandler:c=>{c.buttons||je(c.position)},outHandler:()=>{w=null,P.style.display="none"},stopHandler:()=>{w&&v.lastMousePosition&&je(v.lastMousePosition)}}),fetch("data/coordinate_maps.json").then(c=>c.json()).then(c=>{window.songCoordinates=c}).catch(c=>console.error("Error loading coordinates:",c));const ge=document.getElementById("songModal"),rt=ge.querySelector(".close-button"),ae=document.getElementById("left-sidebar"),U=ae.querySelector(".left-sidebar-title"),k=ae.querySelector(".left-sidebar-content"),Be=document.getElementById("close-left-sidebar-btn"),Ce=document.getElementById("activity-btn"),Ie=document.getElementById("collectors-btn"),ye=document.getElementById("for-sale-btn"),pe=document.getElementById("for-sale-count");rt.addEventListener("click",()=>ge.style.display="none"),ge.addEventListener("click",c=>{c.target===ge&&(ge.style.display="none")});function yt(c){return c?c.includes("youtu.be")?c.split("youtu.be/")[1]:new URL(c).searchParams.get("v"):null}async function We(c){try{const m=await i.getObject(c.toString());if(!m){console.error("Song not found in Algolia:",c);return}const E=ge.querySelector(".modal-content");if(E.querySelector(".song-title").textContent=m.name,E.querySelector(".song-number").textContent=`Song #${m.token_id}`,q&&m.token_id){const y=document.createElement("a");y.href=`https://opensea.io/assets/ethereum/${q}/${m.token_id}`,y.textContent="View on OpenSea",y.target="_blank",y.style.display="inline-block",y.style.margin="8px 0",y.style.fontWeight="600",y.className="external-link os-link";const p=E.querySelector(".song-number");p==null||p.after(y)}const O=E.querySelector(".video-container");if(O.innerHTML="",m.youtube_url){const y=yt(m.youtube_url);if(y){const p=document.createElement("iframe");p.src=`https://www.youtube.com/embed/${y}`,p.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",p.allowFullscreen=!0,O.appendChild(p)}}const d=E.querySelector(".attributes-grid");d.innerHTML="",m.attributes&&Array.isArray(m.attributes)&&m.attributes.forEach(y=>{if(y.trait_type!=="Song A Day"){const p=document.createElement("div");p.className="attribute-item",p.innerHTML=`<div class="attribute-label">${y.trait_type}</div><div class="attribute-value">${y.value}</div>`,d.appendChild(p)}});const C=E.querySelector(".external-links");if(C.innerHTML="",m.external_url){const y=document.createElement("a");y.href=m.external_url,y.className="external-link",y.textContent="View on Song A Day",y.target="_blank",C.appendChild(y)}ge.style.display="block"}catch(m){console.error("Error fetching song details from Algolia:",m)}}v.addHandler("canvas-click",function(c){if(!c.quick)return;const m=me(c.position);m&&We(m.id)});let Fe=new Map,be=new Map;function bt(c){const m=(c-1)%Z,E=Math.floor((c-1)/Z),O=new OpenSeadragon.Rect(m*M,E*I,M,I),d=document.createElement("div");d.style.position="absolute",d.style.background="rgba(0,0,0,0.5)",d.style.pointerEvents="none",d.style.zIndex="1001";const C=v.viewport.imageToViewportRectangle(O),y=v.viewport.viewportToViewerElementRectangle(C);return d.style.left=y.x+"px",d.style.top=y.y+"px",d.style.width=y.width+"px",d.style.height=y.height+"px",v.canvas.appendChild(d),v.addHandler("animation",()=>{if(!d.parentNode)return;const p=v.viewport.imageToViewportRectangle(O),S=v.viewport.viewportToViewerElementRectangle(p);d.style.left=S.x+"px",d.style.top=S.y+"px",d.style.width=S.width+"px",d.style.height=S.height+"px"}),d}function vt(){const c=[];return be.forEach((m,E)=>{const O=[];m.forEach(d=>{O.push(`${E}:${d}`)}),O.length>0&&c.push(O)}),c}async function wt(){Fe.forEach(m=>m.remove()),Fe.clear();const c=vt();if(c.length!==0)try{const{hits:m}=await i.search("",{facetFilters:c,attributesToRetrieve:["objectID"],hitsPerPage:5852}),E=new Set(m.map(d=>parseInt(d.objectID,10)));Ae().forEach(d=>{if(!E.has(d.id)){const C=bt(d.id);Fe.set(d.id,C)}})}catch(m){console.error("Error applying filters with Algolia:",m)}}async function xt(){const c=document.querySelector("#right-sidebar .filter-content");c.innerHTML="";const m=["Topic","Genre","Mood","Location","Instrument","Style","Noun","Proper Noun"];try{const{facets:E}=await i.search("",{facets:m,hitsPerPage:0});if(!E){console.error("No facets received from Algolia.");return}m.forEach(O=>{const d=E[O];if(!d||Object.keys(d).length===0)return;const C=document.createElement("div");C.className="filter-section";const y=document.createElement("div");y.className="filter-section-header",y.innerHTML=`<span class="filter-section-title">${O}</span><span class="filter-count">${Object.keys(d).length}</span>`;const p=document.createElement("div");p.className="filter-options",p.style.display="none",Object.entries(d).sort(([,A],[,h])=>h-A).sort(([A],[h])=>A.localeCompare(h)).forEach(([A,h])=>{const f=document.createElement("div");f.className="filter-option";const T=`filter-${O}-${A}`.replace(/\s+/g,"-").toLowerCase();f.innerHTML=`
                        <input type="checkbox" id="${T}" class="filter-checkbox" data-trait="${O}" data-value="${A}">
                        <label for="${T}" class="filter-label"><span class="filter-value">${A}</span><span class="filter-value-count">${h}</span></label>`,f.querySelector("input").addEventListener("change",L=>{const H=L.target.dataset.trait,G=L.target.dataset.value;be.has(H)||be.set(H,new Set),L.target.checked?be.get(H).add(G):(be.get(H).delete(G),be.get(H).size===0&&be.delete(H)),wt(),L.stopPropagation()}),p.appendChild(f)}),C.appendChild(y),C.appendChild(p),c.appendChild(C),y.addEventListener("click",()=>{const A=p.style.display==="none";document.querySelectorAll(".filter-options").forEach(h=>h.style.display="none"),A&&(p.style.display="block")})})}catch(E){console.error("Error initializing filter sections from Algolia:",E)}}function Je(){const c=document.getElementById("right-sidebar");c.classList.contains("visible")?c.classList.remove("visible"):(c.classList.add("visible"),c.hasAttribute("data-initialized")||(xt(),c.setAttribute("data-initialized","true")))}const ot=document.getElementById("explore-btn");ot&&ot.addEventListener("click",Je);const it=document.getElementById("close-filter-btn");it&&it.addEventListener("click",Je);const He=document.createElement("style");He.textContent=`
        .filter-option{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;}
        .filter-option:hover{background:rgba(0,0,0,0.05);}
        .filter-label{flex:1;display:flex;justify-content:space-between;align-items:center;margin-left:12px;cursor:pointer;}
        .filter-value{color:black;}
        .filter-value-count{color:#666;font-size:14px;}
        .filter-section-header{padding:12px 16px;}
        .filter-options{background:#f5f5f5;margin:0 -20px;}
    `,document.head.appendChild(He),v.addHandler("open",()=>{v.viewport.goHome(!0);const c=v.viewport.getHomeBounds();typeof v.viewport.fitBounds=="function"&&v.viewport.fitBounds(c,!0)});const De=document.getElementById("osd-controls-container"),It=tt({icon:"zoom_in",label:"Zoom in",onClick:()=>{v.viewport.zoomBy(1.2),v.viewport.applyConstraints()}}),St=tt({icon:"zoom_out",label:"Zoom out",onClick:()=>{v.viewport.zoomBy(1/1.2),v.viewport.applyConstraints()}}),Et=tt({icon:"home",label:"Reset view",onClick:()=>v.viewport.goHome()}),Le=tt({icon:"gif",label:"Toggle GIFs",onClick:()=>{te=!te,Le.classList.toggle("active",te),Ge()}}),Ot=tt({icon:"filter_list",label:"Filter",onClick:()=>Je()});De.appendChild(It),De.appendChild(St),De.appendChild(Et),De.appendChild(Le),De.appendChild(Ot);async function Pt(){if(!F||!pe){pe&&(pe.textContent="N/A");return}try{const c=await Ht(F,b,"ethereum",z,0),E=new Set(c.map(O=>{var d,C,y,p;return(p=(y=(C=(d=O==null?void 0:O.protocol_data)==null?void 0:d.parameters)==null?void 0:C.offer)==null?void 0:y[0])==null?void 0:p.identifierOrCriteria}).filter(O=>O!=null)).size;pe.textContent=E.toString()}catch(c){console.error("Failed to update for-sale count:",c),pe&&(pe.textContent="N/A")}}async function kt(){console.log("initOpenSea called. API Key:","Present","Contract:","Present");try{const c=await dn(q,b);c?(F=c,console.log("Fetched OpenSea collection slug:",F),await Pt()):(console.error("Failed to fetch OpenSea collection slug. Slug was null or empty."),pe&&(pe.textContent="N/A"),Ce&&(Ce.disabled=!0),Ie&&(Ie.disabled=!0),ye&&(ye.disabled=!0))}catch(c){console.error("Error initializing OpenSea:",c),pe&&(pe.textContent="N/A"),Ce&&(Ce.disabled=!0),Ie&&(Ie.disabled=!0),ye&&(ye.disabled=!0)}}async function Ke(c,m){if(console.log(`openLeftSidebar called with contentType: ${c}, title: ${m}`),!ae||!U||!k){console.error("Left sidebar elements not found!");return}if(!F&&(c==="forSale"||c==="activity"||c==="collectors")&&(U.textContent=m,k.innerHTML="<p>Initializing OpenSea data...</p>",console.log("Attempting to show left sidebar for initializing OpenSea"),ae.classList.add("visible"),await kt(),!F)){U.textContent="Error",k.innerHTML="<p>Could not load collection data. Please check console for errors.</p>",console.log("Attempting to show left sidebar for slug fetch error"),ae.classList.add("visible");return}U.textContent=m,k.innerHTML="<p>Loading data...</p>",ae.classList.contains("visible")||(console.log("Attempting to show left sidebar for content loading"),ae.classList.add("visible"));try{let E;if(!F)throw new Error("Collection slug not available.");switch(c){case"forSale":E=await Ht(F,b,"ethereum",z,0),await Ct(E,k);break;case"activity":if(!k.querySelector(".activity-tabs")){const d=document.createElement("div");d.className="activity-tabs",d.style.display="flex",d.style.gap="12px",d.style.marginBottom="12px",[{label:"Listings",type:"listing"},{label:"All",type:null},{label:"Sales",type:"sale"},{label:"Offers",type:"offer"}].forEach(y=>{const p=document.createElement("button");p.textContent=y.label,p.className="activity-tab-btn",p.dataset.eventType=y.type??"",p.style.padding="6px 10px",p.style.border="none",p.style.borderRadius="4px",p.style.cursor="pointer",p.style.background="rgba(255,255,255,0.1)",p.style.color="#fff",p.addEventListener("click",async()=>{var S;Array.from(d.children).forEach(A=>A.classList.remove("active")),p.classList.add("active"),(S=k.querySelector(".activity-list"))==null||S.remove(),await O(y.type)}),d.appendChild(p)}),d.firstChild.classList.add("active"),k.innerHTML="",k.appendChild(d)}const O=async d=>{var y,p,S,A,h,f,T,L,H;(y=k.querySelector(".activity-loading"))==null||y.remove();const C=document.createElement("p");C.textContent="Loading activity...",C.className="activity-loading",k.appendChild(C);try{const re=(await fn(F,b,"ethereum",d,50)).filter(se=>se.order_type!=="collection_offer");let he=re;if(d==="listing"){const se=new Set,ce=[];for(const $ of re){const de=((p=$==null?void 0:$.nft)==null?void 0:p.identifier)??((S=$==null?void 0:$.asset)==null?void 0:S.token_id)??((T=(f=(h=(A=$==null?void 0:$.protocol_data)==null?void 0:A.parameters)==null?void 0:h.offer)==null?void 0:f[0])==null?void 0:T.identifierOrCriteria)??null,fe=((L=$==null?void 0:$.nft)==null?void 0:L.name)||((H=$==null?void 0:$.asset)==null?void 0:H.name)||"";let W=null;de!=null?W=`id-${de}`:fe&&(W=`title-${fe.toLowerCase()}`),!(W&&se.has(W))&&(W&&se.add(W),ce.push($))}he=ce}qe(he,k)}catch(G){console.error("Activity load error",G),C.textContent="Failed to load activity."}finally{C.remove()}};await O("listing");return;case"collectors":E=await pn(F,b,"ethereum",100),at(E,k);break;default:k.innerHTML="<p>Selected section not yet implemented.</p>"}}catch(E){console.error(`Error fetching OpenSea ${c} data:`,E)}}Ce&&Ce.addEventListener("click",()=>{console.log("Activity button clicked"),Ke("activity","Collection Activity")}),Ie&&Ie.addEventListener("click",()=>{console.log("Collectors button clicked"),Ke("collectors","Top Collectors (Sample")}),ye&&ye.addEventListener("click",()=>{console.log("For Sale button clicked"),Ke("forSale","Items For Sale")}),Be&&Be.addEventListener("click",()=>{console.log("Close left sidebar button clicked"),ae.classList.remove("visible")});function Qe(c,m=18,E=4){try{if(!c)return"0";const O=BigInt(c.toString()),d=BigInt(10)**BigInt(m),C=O/d;let p=(O%d).toString().padStart(m,"0");return p=p.slice(0,E),p=p.replace(/0+$/,""),p.length>0?`${C}.${p}`:C.toString()}catch{return"0"}}async function Ct(c,m){if(m.innerHTML="",!c||c.length===0){m.innerHTML="<p>No items currently for sale.</p>";return}const E=new Map,O=[];c.forEach(S=>{var T,L,H,G,re,he,se,ce;const A=(G=(H=(L=(T=S==null?void 0:S.protocol_data)==null?void 0:T.parameters)==null?void 0:L.offer)==null?void 0:H[0])==null?void 0:G.identifierOrCriteria;if(A==null){O.push(S);return}const h=A.toString(),f=E.get(h);if(!f)E.set(h,S);else{const $=(he=(re=S.price)==null?void 0:re.current)!=null&&he.value?BigInt(S.price.current.value):BigInt(0),de=(ce=(se=f.price)==null?void 0:se.current)!=null&&ce.value?BigInt(f.price.current.value):BigInt(0);if($<de)E.set(h,S);else if($===de){const fe=W=>Date.parse(W.created_date||W.order_created_date||W.listing_date||W.updated_date||0);fe(S)>fe(f)&&E.set(h,S)}}});let d=[...E.values(),...O];const C=document.createElement("ul");C.style.listStyleType="none",C.style.paddingLeft="0",d.sort((S,A)=>{var T,L,H,G;const h=(L=(T=S.price)==null?void 0:T.current)!=null&&L.value?BigInt(S.price.current.value):BigInt(0),f=(G=(H=A.price)==null?void 0:H.current)!=null&&G.value?BigInt(A.price.current.value):BigInt(0);return h>f?1:h<f?-1:0});const y=d.map(S=>{var h,f,T,L;const A=(L=(T=(f=(h=S.protocol_data)==null?void 0:h.parameters)==null?void 0:f.offer)==null?void 0:T[0])==null?void 0:L.identifierOrCriteria;return A?A.toString():null}).filter(Boolean),p={};if(y.length)try{const{results:S}=await i.getObjects(y);S.forEach(A=>{A&&(p[A.objectID]=A.name)})}catch(S){console.error("Error fetching titles from Algolia:",S)}d.forEach(S=>{var se,ce,$,de,fe,W,ve,Se,Ee,we,xe,Ne,Re,Oe,Pe;const A=document.createElement("li");A.style.padding="8px 0",A.style.borderBottom="1px solid #444";let h=null;($=(ce=(se=S.protocol_data)==null?void 0:se.parameters)==null?void 0:ce.offer)!=null&&$.length&&(h=S.protocol_data.parameters.offer[0].identifierOrCriteria);const f=h!=null?h.toString():null,T=f&&p[f]||((de=S.nft)==null?void 0:de.name)||((fe=S.asset)==null?void 0:fe.name)||(h?`Song #${h}`:"Unknown Song"),L=(ve=(W=S.price)==null?void 0:W.current)==null?void 0:ve.value,H=((Ee=(Se=S.price)==null?void 0:Se.current)==null?void 0:Ee.decimals)||18,G=L?Qe(L,H):"N/A",re=((xe=(we=S.price)==null?void 0:we.current)==null?void 0:xe.currency)||"ETH",he=((Ne=S.nft)==null?void 0:Ne.image_url)||((Re=S.nft)==null?void 0:Re.display_image_url)||((Oe=S.asset)==null?void 0:Oe.image_url)||((Pe=S.asset)==null?void 0:Pe.display_image_url)||"";A.innerHTML=`<div style="display:flex;gap:10px;align-items:center;">
                    <img src="${he}" style="width:48px;height:48px;object-fit:cover;border-radius:4px;background:#222;" />
                    <div style="flex:1;">
                        <div style="font-weight:600;">${T}</div>
                        <div style="font-size:12px;color:#aaa;">Song #${h??"â"}</div>
                    </div>
                    <div style="text-align:right;white-space:nowrap;">${G} ${re}</div>
                 </div>`,C.appendChild(A)}),m.appendChild(C)}function qe(c,m){var A;const E=h=>{var f,T,L,H,G,re;return((f=h==null?void 0:h.nft)==null?void 0:f.identifier)??((T=h==null?void 0:h.asset)==null?void 0:T.token_id)??((re=(G=(H=(L=h==null?void 0:h.protocol_data)==null?void 0:L.parameters)==null?void 0:H.offer)==null?void 0:G[0])==null?void 0:re.identifierOrCriteria)??null};if((A=m.querySelector(".activity-list"))==null||A.remove(),!c||c.length===0){const h=document.createElement("p");h.textContent="No recent activity.",m.appendChild(h);return}const O=new Set;c.forEach(h=>{const f=E(h);f!=null&&O.add(f.toString())});const d={},C={},y=new Set;c.forEach(h=>{var T,L;const f=E(h);if(f==null){const H=(((T=h==null?void 0:h.nft)==null?void 0:T.name)||((L=h==null?void 0:h.asset)==null?void 0:L.name)||"").trim();H&&y.add(H.toLowerCase())}});const p=[];if(O.size&&p.push(i.getObjects(Array.from(O)).then(({results:h})=>{h.forEach(f=>{f&&(d[f.objectID]=f.name)})}).catch(h=>console.error("Algolia title fetch error",h))),y.size){const h=Array.from(y).map(f=>i.search(f,{hitsPerPage:1,restrictSearchableAttributes:["name"],attributesToRetrieve:["objectID"]}).then(T=>{const L=T.hits&&T.hits[0];L&&(C[f]=L.objectID,d[L.objectID]=L.name||f)}).catch(T=>console.error("Algolia lookup error",T)));p.push(Promise.all(h))}Promise.all(p).then(S).catch(h=>{console.error("Algolia async error",h),S()});function S(){const h=document.createElement("ul");h.className="activity-list",h.style.listStyleType="none",h.style.paddingLeft="0",c.forEach(f=>{var st,ct,Ye,ut,lt,dt,ft,pt;const T=document.createElement("li");T.className="activity-row",T.style.display="flex",T.style.alignItems="center",T.style.gap="12px",T.style.padding="10px 0",T.style.borderBottom="1px solid #444";const L=document.createElement("img");L.className="activity-thumb",L.style.width="48px",L.style.height="48px",L.style.objectFit="cover",L.style.borderRadius="4px";const H=((st=f.nft)==null?void 0:st.display_image_url)||((ct=f.nft)==null?void 0:ct.image_url)||((Ye=f.asset)==null?void 0:Ye.display_image_url)||((ut=f.asset)==null?void 0:ut.image_url)||"";H?L.src=H:L.style.background="#222",T.appendChild(L);let G=E(f);if(G==null){const K=(((lt=f.nft)==null?void 0:lt.name)||((dt=f.asset)==null?void 0:dt.name)||"").trim().toLowerCase();K&&C[K]&&(G=C[K])}const re=G!=null?G.toString():"",he=re&&d[re]||((ft=f.nft)==null?void 0:ft.name)||((pt=f.asset)==null?void 0:pt.name)||`Song #${re}`,se=f.event_type.replace(/_/g," "),ce=document.createElement("div");ce.style.flex="1";const $=document.createElement("span");$.textContent=se.charAt(0).toUpperCase()+se.slice(1),$.className=`activity-badge badge-${f.event_type}`,$.style.padding="2px 6px",$.style.borderRadius="4px",$.style.fontSize="11px",$.style.fontWeight="700",$.style.textTransform="capitalize",$.style.marginRight="6px";const de={sale:"#1f7a3d",listing:"#7a3d1f",offer:"#3d5d7a"};$.style.background=de[f.event_type]||"#555",$.style.color="#fff";const fe=document.createElement("span");fe.textContent=he;const W=document.createElement("div");W.appendChild($),W.appendChild(fe);const ve=K=>K?`${K.slice(0,4)}â¦${K.slice(-4)}`:"";let Se="";f.buyer&&f.seller?Se=`${ve(f.seller)} â ${ve(f.buyer)}`:f.maker&&f.taker!==void 0&&(Se=`${ve(f.maker)} â ${ve(f.taker||"")}`);const Ee=document.createElement("div");Ee.style.fontSize="11px",Ee.style.color="#aaa",Ee.textContent=Se,ce.appendChild(W),Se&&ce.appendChild(Ee),T.appendChild(ce);const we=document.createElement("div");we.style.textAlign="right",we.style.fontSize="12px";let xe="";f.payment&&f.payment.quantity?xe=`${Qe(f.payment.quantity,f.payment.decimals||18,3)} ${f.payment.symbol||"ETH"}`:f.total_price&&f.payment_token&&(xe=`${Qe(f.total_price,f.payment_token.decimals||18,3)} ${f.payment_token.symbol}`);const Ne=document.createElement("div");Ne.textContent=xe;const Re=f.event_timestamp||f.closing_date||null;let Oe="";if(Re){const K=Math.floor(Date.now()/1e3)-Re,Xe=[{l:"y",s:31536e3},{l:"mo",s:2592e3},{l:"d",s:86400},{l:"h",s:3600},{l:"m",s:60}];for(const _e of Xe)if(K>=_e.s){Oe=`${Math.floor(K/_e.s)}${_e.l}`;break}Oe||(Oe=`${K}s`)}const Pe=document.createElement("div");Pe.style.color="#aaa",Pe.style.fontSize="10px",Pe.textContent=Oe,we.appendChild(Ne),we.appendChild(Pe),T.appendChild(we),h.appendChild(T),G&&(T.addEventListener("mouseenter",()=>{const K=parseInt(re,10);if(!Number.isFinite(K)||K<1||K>5852)return;const Xe=(K-1)%Z,_e=Math.floor((K-1)/Z),ke=new OpenSeadragon.Rect(Xe*M,_e*I,M,I),$e=1.5,Tt=ke.width*($e-1)/2,At=ke.height*($e-1)/2,mt=new OpenSeadragon.Rect(ke.x-Tt,ke.y-At,ke.width*$e,ke.height*$e),jt=v.viewport.imageToViewportRectangle(mt);v.viewport.fitBounds(jt,!1);const ze=v.viewport.viewportToViewerElementRectangle(v.viewport.imageToViewportRectangle(ke));P.style.left=ze.x+"px",P.style.top=ze.y+"px",P.style.width=ze.width+"px",P.style.height=ze.height+"px",P.style.display="block"}),T.addEventListener("mouseleave",()=>{P.style.display="none"}),T.addEventListener("click",()=>{const K=parseInt(re,10);Number.isFinite(K)&&We(K)})),T.addEventListener("mouseenter",()=>{T.style.background="rgba(255,255,255,0.05)"}),T.addEventListener("mouseleave",()=>{T.style.background=""})}),m.appendChild(h)}}function at(c,m){m.innerHTML="";const{collectors:E,totalScanned:O}=c;if(!E||E.length===0){m.innerHTML="<p>No collector data available from the scanned NFTs.</p>";return}const d=document.createElement("p");d.textContent=`Showing top collectors from ${O} recently processed NFTs (sample):`,d.style.fontSize="12px",d.style.color="#aaa",m.appendChild(d);const C=document.createElement("ul");C.style.listStyleType="none",C.style.paddingLeft="0",E.forEach(y=>{const p=document.createElement("li");p.style.padding="5px 0",p.innerHTML=`<span>${y.address.substring(0,6)}...${y.address.substring(y.address.length-4)}</span> (owns <strong>${y.count}</strong>)</span>`,C.appendChild(p)}),m.appendChild(C)}})();
